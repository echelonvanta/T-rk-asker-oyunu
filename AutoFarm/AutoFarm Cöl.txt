local Players = game:GetService("Players")
local VirtualInputManager = game:GetService("VirtualInputManager")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")

local LocalPlayer = Players.LocalPlayer

local anaUsPlaceId = 3231515867
local colSehriPlaceId = 6912372358

for _, effect in pairs(Lighting:GetChildren()) do
    if effect:IsA("BlurEffect") then
        effect.Enabled = false
    end
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoFarmGUI"
screenGui.Parent = game.CoreGui

local infoLabel = Instance.new("TextLabel")
infoLabel.Size = UDim2.new(0, 250, 0, 30)
infoLabel.Position = UDim2.new(0, 10, 0, 10)
infoLabel.BackgroundTransparency = 1
infoLabel.TextColor3 = Color3.new(1,1,1)
infoLabel.Font = Enum.Font.SourceSansBold
infoLabel.TextSize = 18
infoLabel.Text = "Bekleniyor..."
infoLabel.Parent = screenGui

local function tweenTo(position, duration)
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") and char:FindFirstChildOfClass("Humanoid") then
        local humanoid = char:FindFirstChildOfClass("Humanoid")
        local hrp = char.HumanoidRootPart
        
        humanoid.Jump = true
        wait(0.5)
        
        local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Linear)
        local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(position)})
        tween:Play()
        tween.Completed:Wait()
    end
end

local function killNPCsFor(seconds)
    local start = tick()
    while tick() - start < seconds do
        for _, npc in pairs(game:GetDescendants()) do
            if npc:IsA("Humanoid") and npc.Health > 0 and npc.Parent.Name ~= LocalPlayer.Name then
                npc.Health = 0
            end
        end
        wait(0.3)
    end
end

local function waitWithCountdown(seconds, label)
    for i = seconds, 1, -1 do
        label.Text = "Bekleniyor... " .. i .. " saniye"
        wait(1)
    end
end

local function clickButtonSequence()
    local playerGui = LocalPlayer:WaitForChild("PlayerGui")
    local operasyonGui = playerGui:WaitForChild("Operasyon")
    operasyonGui.Enabled = true

    local operasyonPanel = operasyonGui:WaitForChild("Operasyon")
    operasyonPanel.Visible = true

    task.wait(0.5)

    local scrollingFrame = operasyonPanel:WaitForChild("ScrollingFrame")
    local colSehriFrame = scrollingFrame:WaitForChild("Çöl Şehri")
    local imageButton = colSehriFrame:WaitForChild("Button")

    local absPos = imageButton.AbsolutePosition
    local absSize = imageButton.AbsoluteSize
    local centerX = absPos.X + absSize.X / 2
    local centerY = absPos.Y + absSize.Y / 2

    local offsetY = 30
    local clickX = centerX
    local clickY = centerY + offsetY

    VirtualInputManager:SendMouseButtonEvent(clickX, clickY, 0, true, game, 0)
    task.wait(0.1)
    VirtualInputManager:SendMouseButtonEvent(clickX, clickY, 0, false, game, 0)

    task.wait(5)

    local baslatX, baslatY = 575.49 + 15, 266.63 + 35

    VirtualInputManager:SendMouseButtonEvent(baslatX, baslatY, 0, true, game, 0)
    task.wait(0.1)
    VirtualInputManager:SendMouseButtonEvent(baslatX, baslatY, 0, false, game, 0)
end

local hedef1 = Vector3.new(321.13, 3.63, 11.17)
local hedef2 = Vector3.new(752.00, 3.35, -46.60)

while true do
    if game.PlaceId == anaUsPlaceId then
        infoLabel.Text = "Ana Üstesin, butonlar tıklanıyor..."
        clickButtonSequence()
        infoLabel.Text = "Buton tıklama tamamlandı, farming bekleniyor..."
        wait(10)

    elseif game.PlaceId == colSehriPlaceId then
        infoLabel.Text = "Çöl Şehri'ndesin, farming başlıyor..."
        
        waitWithCountdown(15, infoLabel)

        infoLabel.Text = "Hedef 1'e gidiliyor..."
        tweenTo(hedef1, 5)

        infoLabel.Text = "Hedef 1'de NPC öldürülüyor..."
        killNPCsFor(5)

        waitWithCountdown(2, infoLabel)

        infoLabel.Text = "Hedef 2'ye gidiliyor..."
        tweenTo(hedef2, 5)

        infoLabel.Text = "Hedef 2'de NPC öldürülüyor..."
        killNPCsFor(5)

        infoLabel.Text = "Ana üsse ışınlanmadan önce bekleniyor..."
        wait(5)

        infoLabel.Text = "Ana üsse ışınlanılıyor..."
        TeleportService:Teleport(anaUsPlaceId, LocalPlayer)
        wait(10)

    else
        infoLabel.Text = "Bilinmeyen yerde bekleniyor..."
        wait(5)
    end
end